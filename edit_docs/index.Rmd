--- 
title: "The Kidney-Genetics Documentation"
author: "Bernt Popp, Nina Rank, Constantin Wolff, Jan Halbritter"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
output: bookdown::gitbook
bibliography: [kidney-genetics.bib]
csl: apa.csl
link-citations: yes
colorlinks: yes
description: "This documentation is intended to describe the Kidney-Genetics project"
graphics: yes
github-repo: halbritter-lab/kidney-genetics
url: https://halbritter-lab.github.io/kidney-genetics/
---

<!-- here we load required libraries -->
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
## Load libraries
library(readr) # needed to import CSV result files
library(tidyverse) # needed to transform the tables
library(DT) # needed to generate nice data tables in html
library(plotly) # needed for upset plots
library(knitr) # needed for draw.io files
library(knitrdrawio) # needed for draw.io files
library(config) # needed to load the config file
```

<!-- here we load the config file -->
```{r, echo=FALSE, message=FALSE, warning=FALSE}
project_topic <- "nephrology"
project_name <- "kidney-genetics"
script_path <- "/edit_docs/"

## read configs
config_vars_proj <- config::get(file = Sys.getenv("CONFIG_FILE"),
    config = project_topic)
```

<!-- here we load global functions libraries -->
```{r, echo=FALSE, message=FALSE, warning=FALSE}
# load global functions
# file functions
source("../analyses/functions/file-functions.R", local = TRUE)
```

<!-- TODO: load and filter (newest) the files automatically  -->
<!-- TODO: also compute other numbers with placeholders -->
<!-- TODO: version the image files with their computation date -->
<!-- TODO: create output folder if not existent -->

<!-- here we load the result csv file and compute numbers to update the diagrams -->
```{r, echo=FALSE, message=FALSE, warning=FALSE}
## load the CSV data
merge_analyses_sources <- read_csv("../analyses/A_MergeAnalysesSources/results/A_MergeAnalysesSources.2023-05-18.csv.gz")

# compute numbers for the diagrams
all_genes <- merge_analyses_sources %>%
    nrow()

high_evidence_genes <- merge_analyses_sources %>%
    filter(evidence_count > 2) %>%
    nrow()

clingen_genes <- "XXX"
manualscoring_genes <- "YYY"

replace_strings("static/img/figures/raw/curation_flow_diagram_raw.drawio",
    "static/img/figures/updated/curation_flow_diagram_current.drawio",
    c("ALL_GENES", "HIGHEVIDENCE_GENES", "CLINGEN_GENES", "MANUALSCORING_GENES"),
    c(all_genes, high_evidence_genes, clingen_genes, manualscoring_genes))
```

---

# Preface {-}

---------------------------------------

This documentation is intended to describe the [Kidney-Genetics](https://github.com/halbritter-lab/kidney-genetics) project.

<!-- here we place the logo -->
```{r, out.width='25%', fig.align='center', echo=FALSE, message=FALSE, warning=FALSE}
knitr::include_graphics("static/img/logo/kidney-genetics_logo.svg")
```

## Objective {-}

> How can we address the lack of a unified and standardized database of kidney disease-associated genes, which hampers diagnosis, treatment, and research comparability in the field of kidney diseases?  

Genetic insights are becoming increasingly influential in the understanding and treatment of various kidney diseases (KD). Hundreds of genes associated with monogenic kidney disease have been identified, providing valuable insights into their diagnosis, management, and monitoring. 
However, the lack of a unified and standardized database of genes assigned to kidney diseases has led to diagnostic blind spots and comparability issues among current studies of kidney genetics. 
To address this gap, we created the **“Kidney-Genetics”** a regularly updated, automated and publicly accessible database which aims to provide a comprehensive list of all relevant genes associated with kidney disease.  

> **Key issues:**  

- Create a unified and standardized database of kidney disease-associated genes and provide a valuable resource for the diagnosis, treatment, and monitoring of those diseases  
- Allow clinicians and researchers to gain a deeper understanding of the genetic factors underlying different KDs  
- Compile, organize and curate important information on the genes to the identify novel candidate genes and genetic variants associated with KDs  
- Group and sort the genes into different categories, for example into phenotypic groups, the onset, syndromic, etc.  
- Establish genotype-phenotype correlations that can be used to assign multiple clinical entities to a single gene in order to improve understanding and treatment choices  
- The information can be used to develop personalized treatment strategies and interventions, leading to more effective and targeted therapies for individuals with KD  
- Researchers can freely access "Kidney-Genetics" ensuring consistency and comparability across different research projects, which can accelerate scientific progress, foster collaborations, and facilitate the development of new insights and approaches  

The scientific literature highlights the need for such a database and emphasizes the importance of genetic research in kidney disease. For example, a study published xxx. Another article published in xxx.  
<!-- TODO: Scan literature that notices a scientific need for a standardized kidney gene database (see some interesting paper in the references section) -->

> In summary, our research question and its approach have the potential to provide a deeper scientific understanding of KD genetics, improve diagnostic accuracy, guide treatment selection, advance precision medicine, and facilitate research collaboration. The establishment of the **"Kidney-Genetics"** database addresses an important gap in the field and provides a valuable resource for researchers, clinicians, and patients involved in the discovery and treatment of KD.  


## Methods {-}

> To create a thorough and standardized database of kidney-related genes, we employed the following methods and compiled kidney disease-associated gene information from various sources:  

1. Utilized data from Genomics England and Australia PanelApp  
2. Conducted a comprehensive literature review of published gene lists  
3. Collected information from clinical diagnostic panels for kidney disease  
4. Performed a Human Phenotype Ontology (HPO)-based search in rare disease databases (OMIM, Orphanet)  
5. Employed a PubTator API-based automated literature extraction from PubMed  

We also developed an evidence-scoring system to differentiate highly confirmed disease genes from candidate genes. We defined the presence of a certain gene in 3 or more of the 5 resources as highly evident genes. 
These genes were then manually curated according to predetermined criteria or, in the case of existing ClinGen curation, their data and scores were used. Genes with a score of 2 or less were accordingly more likely to be classified as candidate genes.  
Furthermore, we grouped all genes into different categories to later match them in a genotype-phenotype correlation.    
<!-- TODO: Provide detailed information about the different groups and categories and explain our decision for them -->

To get a more transparent and thus more comprehensive understanding of our several evidence source “pillars”, we listed our different steps below and attached a flowchart for better visualization.  

1. We retrieved all kidney disease related panels from both PanelApp UK and PanelApp Australia, meaning all panels that include "renal" or "kidney" in its name. That included xxx different lists. The access date was the xxx.  
2. We identified Genes associated with kidney disease in a systematic Literature search using the following search query:  
      *(1)	"Kidney"[Mesh] OR "Kidney Diseases"[Mesh] OR kidney OR renal* AND  
      *(2)	"Genetic Structures"[Mesh] OR "Genes"[Mesh] OR genetic test OR gene panel OR gene panels OR multigene panel* OR targeted panel*  
    we then screened for published lists and got xxx lists from date to date xxx.  
3. We used ten common diagnostic panels that can be purchased for genome analysis and extracted the screened genes from them. Those included following panels:  
    - Centogene nephrology  
    - Cegat kidney diseases  
    - Preventiongenetics 
    - etc.   
  <!-- TODO: complete the list and provide the links with RMD -->
4. We used eight common databases for rare diseases and screened them for kidney disease associated Genes from a Human Phenotype Ontology (HPO) based search query. 
   The most comprehensive HPO term used was “Abnormality of the upper urinary tract” (HP:0010935) and included all subgroup terms. We deliberately chose these to be somewhat broader in order to fully include all relevant kidney diseases such as CAKUT, among others.  
5. We retrieved all kidney disease associated Genes from a PubTator API-based automated literature extraction of publications available on PubMed.  


> **Kidney-Genetics Flowchart**


```{drawio curation_flow_diagram, src="static/img/figures/updated/curation_flow_diagram_current.drawio", fig.cap = "Curation process flow diagram", engine.path = config_vars_proj$drawio_path}
```


## Results {-}

> The "Kidney-Genetics" database currently contains detailed information on 2.906 kidney-associated genes with detailed annotations on gene function, kidney phenotype, incidence, possible syndromic disease expression and genetic variation. 
To automatically group the genes, we will present the results of phenotypic and functional clustering.  
<!-- TODO: Provide clustering and grouping results with numbers and proportions -->

The number of genes extracted from the five analyzed sources of information is as follows: (1) 546, (2) 822, (3) 911, (4) 779, and (5) 2.032  
Notably, 439 genes (15.1%) of the total 2.906 genes are present in three or more of the analyzed information sources, thus meeting our evidence criteria, indicating high confidence and their potential for diagnostic use. 
Of these genes, 424 (96.6%) are present in at least one, and 56 (12.8%) are present in all comprehensive diagnostic laboratory panels.  
<!-- TODO: compute the gene numbers with placeholders -->

To ensure currency, Kidney-Genetics will be updated regularly and automatically at xxx week intervals. We will also provide phenotypic and functional clustering results to facilitate gene grouping.  
<!-- TODO: Provide information about the planned update framework -->


## Conclusion {-}

> Kidney-Genetics is a comprehensive, free and publicly accessible database that can be used by researchers to analyze genomic data related to KDs. The database will be routinely updated using an automated system and standardized pipeline to ensure that it is always up-to-date with the latest kidney research and diagnostics.  

By utilizing Kidney-Genetics, clinicians, geneticists, and researchers can examine genomic data and improve their understanding of the genetic components of diverse KDs. The code and results are completely available on GitHub. A standardized pipeline and automated system keep our database on the cutting edge of kidney research and diagnostics. 
Screening efforts toward manual curation (such as through the ClinGen initiative) and assignment of diagnostic genes to nephrologic disease groups (e.g., syndromic vs. isolated; adult vs. pediatric; cystic, nephrotic, etc.) are currently in the development process and our goals for the near future.  


## Outlook {-}

Future goals include the further manual curation of the high evident genes to acquire a more accurate individual assessment of each gene. For this purpose, we have developed a standardized curation process based on the ClinGen criteria, as previously discussed in the methods section. 
Furthermore, diagnostic genes will be assigned to certain defined nephrological disease groups, in order to obtain a phenotype-genotype correlation and gain a better clinical understanding.  

